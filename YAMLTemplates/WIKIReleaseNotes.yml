parameters:
- name: template
  type: string 
- name: version
  type: string 

steps:
- task: XplatGenerateReleaseNotes@3
  displayName: 'Generate build release notes'
  inputs:
    outputfile: '$(System.DefaultWorkingDirectory)/ReleaseNotes.md'
    templateLocation: 'File'
    templatefile: '${{parameters.template}}'
    dumpPayloadToConsole: false
    dumpPayloadToFile: false
    replaceFile: True
    getParentsAndChildren: False
    getAllParents: False
    getIndirectPullRequests: False
    checkStage: true
    
- task: richardfennellBM.BM-VSTS-WIKIUpdater-Tasks.WikiUpdaterTask.WikiUpdaterTask@1
  displayName: 'Git based WIKI Updater'
  inputs:
    repo: 'https://blackmarblelabs@dev.azure.com/blackmarblelabs/Living%20The%20Dream/_git/Living-The-Dream.wiki'
    filename: '$(System.StageName)/${{parameters.version}}.md'
    dataIsFile: true
    sourceFile: '$(System.DefaultWorkingDirectory)/ReleaseNotes.md'
    message: 'Release documentation creation'
    gitname: FabrikamRelease
    gitemail: 'FabrikamRelease@blackmarble.com'
    useAgentToken: true
